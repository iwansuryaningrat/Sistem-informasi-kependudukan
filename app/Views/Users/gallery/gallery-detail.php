<?php $this->extend('users/template/layout'); ?>
<?php $this->section('homepage'); ?>

<!-- header -->
<header class="container">
    <div class="header-container-back mb-0">
        <button class="btn btn-main-outline-xs" type="button" onclick="goBack()">
            <i class="fa-solid fa-arrow-left me-2"></i>Kembali
        </button>
    </div>
    <div class="header-container-mini mt-5 pt-0">
        <p class="mb-3">
            <span class="badge badge-done">Kategori 1</span>
        </p>
        <h1 class="mb-3 text-center">Galeri Kegiatan Warga 1</h1>
        <p class="text-basic text-center mb-0 max-w-80">
            Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat
            iusto architecto sint ipsam, labore quo dolore quis voluptate id
            alias, impedit quia! Illum, consequatur quae quo at dolore
            repellendus ipsa.
        </p>
    </div>
</header>
<!-- end of header -->

<!-- main -->
<main>
    <section class="container container-space">
        <!-- only large view -->
        <div class="gallery-view-container-lg">
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-1.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-1.jpg" alt="gallery-view-1" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-11.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-11.jpg" alt="gallery-view-11" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-2.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-2.jpg" alt="gallery-view-2" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-3.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-3.jpg" alt="gallery-view-3" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-5.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-5.jpg" alt="gallery-view-5" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-13.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-13.jpg" alt="gallery-view-13" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-14.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-14.jpg" alt="gallery-view-14" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-8.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-8.jpg" alt="gallery-view-8" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-15.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-15.jpg" alt="gallery-view-15" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-9.png" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-9.png" alt="gallery-view-9" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-16.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-16.jpg" alt="gallery-view-16" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-10.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-10.jpg" alt="gallery-view-10" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-12.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-12.jpg" alt="gallery-view-12" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
            <figure data-fancybox="gallery-large" data-src="/homepage/assets/img/image-4.jpg" class="gallery-view-item__warp">
                <img src="/homepage/assets/img/image-4.jpg" alt="gallery-view-4" class="gallery-view-item" />
                <figcaption class="d-none">
                    <p class="mb-2 text-sm">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam
                        pariatur officiis consequatur et odio quas laborum.
                    </p>
                    <p class="text-xs mb-2 fst-italic text-gray-200">
                        Iwan Suryaningrat - 13 Januari 2023
                    </p>
                </figcaption>
            </figure>
        </div>
    </section>
</main>
<!-- end of main -->

<?php if (session()->get('isLoggedIn')) : ?>
    <!-- button add gallery -->
    <div id="add-gallery-fixed">
        <div class="btn btn-main shadow" data-bs-toggle="modal" data-bs-target="#modalAddPhoto">
            <i class="fa-solid fa-plus"></i>
            <span class="text">Tambah Foto</span>
        </div>
    </div>
<?php endif; ?>

<?= $this->endSection(); ?>

<?= $this->section('custom_modal'); ?>

<!-- modal add gallery -->
<div class="modal fade" id="modalAddPhoto" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalAddPhotoLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <form id="formAddPhoto" class="modal-content" enctype="multipart/form-data" action="/fotocontroller/upload">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="modalAddPhotoLabel">
                    Form Tambah Foto Galeri
                </h1>
                <button type="button" class="btn-close text-sm shadow-none" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- foto -->
                <div class="mb-3">
                    <label for="foto" class="form-label forms-label">Foto</label>
                    <input id="foto" name="foto" type="file" class="filepond" multiple data-allow-reorder="true" data-max-file-size="3MB" data-max-files="5" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-main-sm" id="formAddPhotoBtn">
                    Tambah
                </button>
            </div>
        </form>
    </div>
</div>

<?= $this->endSection(); ?>

<?php $this->section('script'); ?>

<!-- script internal -->
<script>
    //   onclick back to previous page
    function goBack() {
        window.history.back();
    }

    // plugin for filepond
    FilePond.registerPlugin(
        FilePondPluginImagePreview,
        FilePondPluginFileValidateSize
    );
    // filepond options
    FilePond.setOptions({
        server: {
            url: '/fotocontroller/upload',
            process: {
                method: 'POST',
                withCredentials: false,
                headers: {},
                timeout: 7000,
                onload: null,
                onerror: null,
                ondata: null,
            },
        },
        maxFileSize: '3MB',
        required: true,
        allowMultiple: true,
        labelIdle: 'Drag & drop foto anda atau <span class="filepond--label-action">jelajahi</span>',
        labelFileProcessing: 'Sedang diproses...',
        labelFileProcessingComplete: 'Proses selesai',
        labelFileProcessingAborted: 'Proses dibatalkan',
        labelFileProcessingError: 'Kesalahan saat memproses',
        labelTapToCancel: 'Ketuk untuk membatalkan',
        labelTapToRetry: 'Ketuk untuk mencoba kembali',
        labelTapToUndo: 'Ketuk untuk membatalkan',
        labelButtonRemoveItem: 'Hapus',
        labelButtonAbortItemLoad: 'Batal',
        labelButtonRetryItemLoad: 'Coba Lagi',
        labelButtonAbortItemProcessing: 'Batal',
        labelButtonUndoItemProcessing: 'Kembali',
        labelButtonRetryItemProcessing: 'Coba Lagi',
        labelButtonProcessItem: 'Proses',
        labelMaxFileSizeExceeded: 'Ukuran berkas melebihi batas maksimum',
        labelMaxFileSize: 'Ukuran berkas maksimum',
        labelMaxTotalFileSizeExceeded: 'Total ukuran berkas melebihi batas maksimum',
        labelMaxTotalFileSize: 'Total ukuran berkas maksimum',
        labelFileTypeNotAllowed: 'Jenis berkas tidak diizinkan',
        labelFileCountSingular: 'berkas dalam daftar',
        labelFileCountPlural: 'berkas dalam daftar',
        labelUploadError: 'Kesalahan saat mengunggah',
        labelUploadComplete: 'Pengunggahan selesai',
        labelUploadRetry: 'Coba Lagi',
        labelUploadUndo: 'Batalkan',
        labelButtonProcess: 'Proses',
    });
    FilePond.parse(document.body);

    const options = {
        Thumbs: {
            type: 'classic',
        },
        caption: function(fancybox, slide) {
            const figurecaption = slide.triggerEl?.querySelector('figcaption');
            return figurecaption ? figurecaption.innerHTML : slide.caption || '';
        },
        Carousel: {
            Navigation: false,
        },
        Toolbar: {
            display: {
                left: [],
                middle: ['prev', 'infobar', 'next'],
                right: ['slideshow', 'thumbs', 'close'],
            },
        },
        transitionEffect: 'classic',
    };

    Fancybox.bind('[data-fancybox="gallery-large"]', options);
</script>

<script>
    //== Class definition
    var SweetAlert2Demo = function() {

        //== Demos
        var initDemos = function() {

            <?php if (session()->getFlashdata('error')) : ?>
                swal("Ups!", "<?= session()->getFlashdata('error') ?>", {
                    icon: "error",
                    buttons: {
                        confirm: {
                            className: 'btn btn-danger'
                        }
                    },
                });
            <?php endif; ?>

            <?php if (session()->getFlashdata('success')) : ?>
                swal("Selamat!", "<?= session()->getFlashdata('success') ?>", {
                    icon: "success",
                    buttons: {
                        confirm: {
                            className: 'btn btn-success'
                        }
                    },
                });
            <?php endif; ?>
        };

        return {
            //== Init
            init: function() {
                initDemos();
            },
        };
    }();

    //== Class Initialization
    jQuery(document).ready(function() {
        SweetAlert2Demo.init();
    });
</script>

<?= $this->endSection(); ?>